"use strict";(self.webpackChunkzoclass=self.webpackChunkzoclass||[]).push([[6164],{6164:(k,m,i)=>{i.r(m),i.d(m,{UpgradePlanPaymentModule:()=>I});var l=i(36895),d=i(89299),t=i(94650),u=i(24006),f=i(97185),h=i(69678),P=i(26798),x=i(63193),b=i(73716),y=i(88153),v=i(4859),_=i(44850),C=i(97392);function M(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",35)(2,"h3"),t._uU(3,"Student Limit"),t.qZA()(),t.TgZ(4,"div",36)(5,"button",37),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(2);return t.KtG(r.updateNumber(-r.studentIncrementRange))}),t.TgZ(6,"mat-icon"),t._uU(7,"remove"),t.qZA()(),t.TgZ(8,"button",38),t._uU(9),t.qZA(),t.TgZ(10,"button",39),t.NdJ("click",function(){t.CHM(n);const r=t.oxw(2);return t.KtG(r.updateNumber(r.studentIncrementRange))}),t.TgZ(11,"mat-icon"),t._uU(12,"add"),t.qZA()()(),t.BQk()}if(2&e){const n=t.oxw(2);t.xp6(5),t.Q6J("disabled",n.numberOfStudent==(null==n.singlePlanInfo?null:n.singlePlanInfo.studentLimit)),t.xp6(4),t.Oqu(n.numberOfStudent)}}function O(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"div",2)(1,"div",3)(2,"div",4)(3,"div",3)(4,"div",5)(5,"div",3)(6,"div",6)(7,"h2",7),t._uU(8,"Proceed to Payment"),t.qZA(),t.TgZ(9,"div",8)(10,"div",9)(11,"div",10)(12,"h2"),t._uU(13,"Order Summary "),t.qZA()(),t.TgZ(14,"div",11)(15,"div",12)(16,"div",13)(17,"h3"),t._uU(18,"Your Plan"),t.qZA()(),t.TgZ(19,"div",14)(20,"h3",15),t._uU(21),t.qZA()(),t.TgZ(22,"div",13)(23,"h3"),t._uU(24,"Plan Pricing"),t.qZA()(),t.TgZ(25,"div",14)(26,"h3"),t._uU(27),t.ALo(28,"currency"),t.qZA()(),t._UZ(29,"mat-divider"),t.TgZ(30,"div",11)(31,"div",16)(32,"div",13)(33,"h2"),t._uU(34,"Total"),t.qZA()(),t.TgZ(35,"div",14)(36,"h2"),t._uU(37),t.ALo(38,"currency"),t.qZA()()()()()()(),t.TgZ(39,"div",3)(40,"div",11)(41,"button",17),t.NdJ("click",function(){t.CHM(n);const r=t.oxw();return t.KtG(r.createPayment())}),t._uU(42,"Submit Secure Payment"),t.qZA()()(),t.TgZ(43,"div",16),t.YNc(44,M,13,2,"ng-container",18),t.TgZ(45,"div",3)(46,"div",11)(47,"mat-icon",19),t._uU(48,"lock"),t.qZA(),t.TgZ(49,"h3",20),t._uU(50,"Razorpay Secure "),t.qZA()()(),t.TgZ(51,"div",21)(52,"div",3)(53,"div",22),t._UZ(54,"img",23),t.qZA(),t.TgZ(55,"div",22),t._UZ(56,"img",24),t.qZA(),t.TgZ(57,"div",22),t._UZ(58,"img",25),t.qZA(),t.TgZ(59,"div",22),t._UZ(60,"img",26),t.qZA(),t.TgZ(61,"div",22),t._UZ(62,"img",27),t.qZA(),t.TgZ(63,"div",22),t._UZ(64,"img",28),t.qZA()()(),t.TgZ(65,"div",29)(66,"p",30),t._uU(67," +15"),t.qZA()()(),t.TgZ(68,"div",31)(69,"p",32),t._uU(70,"By checking out you agree with our "),t.TgZ(71,"span",33),t._uU(72,"Terms of Service"),t.qZA(),t._uU(73," and confirm that you have read our "),t.TgZ(74,"span",34),t._uU(75,"Privacy Policy"),t.qZA(),t._uU(76,". You can cancel recurring payments at any time. "),t.qZA()()()()()()()()()()}if(2&e){const n=t.oxw();t.xp6(21),t.Oqu(null==n.singlePlanInfo?null:n.singlePlanInfo.plans),t.xp6(6),t.Oqu(t.Dn7(28,5,null==n.singlePlanInfo?null:n.singlePlanInfo.upgradePrice,"INR",!0)),t.xp6(10),t.Oqu(t.Dn7(38,9,n.totalAmount,"INR",!0)),t.xp6(4),t.Q6J("disabled",n.paymentCompleted),t.xp6(3),t.Q6J("ngIf","Plus"!==(null==n.singlePlanInfo?null:n.singlePlanInfo.plans))}}const Z=[{path:"",component:(()=>{class e{constructor(n,o,r,p,c,a,g,A,T,S,w){this.fb=n,this.router=o,this.zone=r,this.el=p,this.renderer=c,this.activatedRoute=a,this.toastr=g,this.paymentService=A,this.adminUserService=T,this.plansService=S,this.adminAuthService=w,this.loader=!0,this.successMsg="",this.paymentMode=!1,this.errorMsg="",this.check=!1,this.paymentCompleted=!1,this.getOTP=!0,this.varifyOTP=!1,this.verified=!1,this.step=1,this.numberOfStudent=0,this.perStudentIncrementPrice=5,this.studentIncrementRange=50}ngOnInit(){this.id=this.activatedRoute.snapshot.paramMap.get("id");let n=this.adminAuthService.getLoggedInAdminInfo();this.adminId=n?.id,this.id&&this.adminId&&(this.getSinglePlans(this.id),this.getSingleAdminUser(this.adminId)),this.loadRazorpayScript(),setTimeout(()=>{this.loader=!1},1e3)}updateNumber(n){this.numberOfStudent+=n,this.totalAmount+=n*this.perStudentIncrementPrice}loadRazorpayScript(){const n=this.renderer.createElement("script");n.type="text/javascript",n.src="https://checkout.razorpay.com/v1/checkout.js",n.onload=()=>{},this.renderer.appendChild(this.el.nativeElement,n)}getSinglePlans(n){this.plansService.getSinglePlans(n).subscribe(o=>{if(o){let r=parseInt(o.upgradePrice);this.taxes=0,this.totalAmount=r+this.taxes,this.numberOfStudent=o.studentLimit,this.perStudentIncrementPrice=o.perStudentIncrementPrice,this.studentIncrementRange=o.studentIncrementRange,this.singlePlanInfo=o}})}getSingleAdminUser(n){this.adminUserService.getSingleAdminUser(n).subscribe(o=>{o&&(this.adminInfo=o)})}createPayment(){this.paymentService.createPayment({adminId:this.adminInfo._id,activePlan:this.singlePlanInfo.plans,amount:this.totalAmount,currency:"INR"}).subscribe(a=>{const g={key:"rzp_live_URUiLO1c3Ant5i",amount:a.order.amount,currency:a.order.currency,name:"Schooliya",description:"Payment for Your Product",image:"../../../../assets/logo.png",prefill:{name:this.adminInfo.name,email:this.adminInfo.email,contact:this.adminInfo.mobile,method:"online"},theme:{color:"#8d6dff"},order_id:a.order.id,handler:this.paymentHandler.bind(this)};Razorpay.open(g)},a=>{this.errorMsg="Payment creation failed. Please try again later."})}paymentHandler(n){this.paymentService.validateUpgradePayment({payment_id:n.razorpay_payment_id,order_id:n.razorpay_order_id,signature:n.razorpay_signature,email:this.adminInfo.email,id:this.adminInfo._id,activePlan:this.singlePlanInfo.plans,amount:this.totalAmount,currency:"INR",studentLimit:this.singlePlanInfo.studentLimit,teacherLimit:this.singlePlanInfo.teacherLimit}).subscribe(a=>{a&&this.zone.run(()=>{this.paymentCompleted=!0,this.errorMsg="",this.successMsg=a.successMsg,this.router.navigate(["/admin/upgrade-plan"],{replaceUrl:!0}),this.toastr.success("","Congratulations! Your plan has been upgraded.")})},a=>{this.zone.run(()=>{this.errorMsg="Payment validation failed. Please contact support."})})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(u.qu),t.Y36(d.F0),t.Y36(t.R0b),t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(d.gz),t.Y36(f._W),t.Y36(h.t),t.Y36(P.N),t.Y36(x.Y),t.Y36(b.Y))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-upgrade-plan-payment"]],decls:3,vars:1,consts:[[2,"background","rgb(243, 241, 250)","padding-top","10vh"],["class","container-fluid","style","padding-bottom: 20vh;",4,"ngIf"],[1,"container-fluid",2,"padding-bottom","20vh"],[1,"row"],[1,"col-lg-10","offset-lg-1"],[1,"col-12","col-lg-6","offset-lg-3"],[1,"col-lg-10","offset-lg-2"],[1,"title"],[1,"cards-second"],[1,"row",2,"padding-bottom","20px"],[1,"col-12","card-title"],[1,"col-12"],[1,"row",2,"padding-top","35px"],[1,"col-6",2,"text-align","left"],[1,"col-6",2,"text-align","right"],[2,"letter-spacing",".5px"],[1,"row",2,"padding-top","15px"],["type","submit","mat-raised-button","",1,"submit-button",2,"width","100% !important","font-size","16px",3,"disabled","click"],[4,"ngIf"],[2,"color","rgb(41, 167, 113)","font-size","21px","display","inline"],[2,"font-size","15px","display","inline","margin-left","10px"],[1,"col-9"],[1,"col-2"],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658384/visa_tnc6fg.png","alt",""],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658336/mastercard_yziy3e.png","alt",""],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658347/paytm_dvbzj5.png","alt",""],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658358/phonepe_bzd1kc.png","alt",""],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658302/google-pay_tvncpj.png","alt",""],["src","https://res.cloudinary.com/dzzrracge/image/upload/v1733658370/upi_ao6vls.png","alt",""],[1,"col-3"],[2,"margin-top","8px"],[1,"col-lg-12"],[2,"color","#000","font-size","15px","margin-top","10px"],["routerLink","/terms-and-conditions",2,"color","#7b48e2","cursor","pointer"],["routerLink","/privacy-policy",2,"color","#7b48e2","cursor","pointer"],[1,"col-5"],[1,"col-7","student-limit",2,"text-align","right"],["mat-icon-button","",1,"decrement-button",3,"disabled","click"],["mat-icon-button","",1,"button"],["mat-icon-button","",1,"increment-button",3,"click"]],template:function(n,o){1&n&&(t._UZ(0,"app-header-navbar"),t.TgZ(1,"div",0),t.YNc(2,O,77,13,"div",1),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",0==o.paymentCompleted))},dependencies:[l.O5,d.rH,y.A,v.lW,_.d,C.Hw,l.H9],styles:[".flm[_ngcontent-%COMP%]{float:left;margin-top:10px}.student-limit[_ngcontent-%COMP%]   .increment-button[_ngcontent-%COMP%]{border-right:1px solid #d1d1d1;border-top:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1;border-radius:0 5px 5px 0}.student-limit[_ngcontent-%COMP%]   .decrement-button[_ngcontent-%COMP%]{border-left:1px solid #d1d1d1;border-top:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1;border-radius:5px 0 0 5px}.student-limit[_ngcontent-%COMP%]   .increment-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%], .student-limit[_ngcontent-%COMP%]   .decrement-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{font-size:16px}.student-limit[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border-top:1px solid #d1d1d1;border-bottom:1px solid #d1d1d1;border-radius:0}.card-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-family:Poppins,sans-serif!important;font-size:22px;font-weight:700;letter-spacing:.5px;text-align:center}.card-detail-title[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#000;font-family:Poppins,sans-serif!important;font-size:22px;font-weight:700;letter-spacing:.5px;text-align:left}.card-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000;font-family:Poppins,sans-serif!important;font-size:15px;font-weight:400;letter-spacing:.5px;text-align:center}.card-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000;font-family:Poppins,sans-serif!important;font-size:15px;font-weight:600;letter-spacing:.5px;text-align:center}.success-message[_ngcontent-%COMP%]{color:#16b978;font-family:Poppins,sans-serif!important;font-size:20px}.error-msg[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#e4409a;font-family:Poppins,sans-serif!important;font-size:16px;letter-spacing:.5px}.submit-button[_ngcontent-%COMP%]{height:50px;background:#804beb;color:#fff;font-family:Poppins,sans-serif!important;box-shadow:none!important}.submit-button.mat-button-disabled[_ngcontent-%COMP%]:not([class*=mat-elevation-z]){background:#9f79eb;color:#f5f3fb;font-family:Poppins,sans-serif!important;cursor:not-allowed}.otp-input[_ngcontent-%COMP%]{display:flex;font-family:Poppins,sans-serif!important;justify-content:center}.otp-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:38px;height:38px;font-size:20px;text-align:center;font-family:Poppins,sans-serif!important;margin-left:5px;margin-right:5px;margin-bottom:30px;border:1px solid #ccc;border-radius:5px}.otp-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;font-family:Poppins,sans-serif!important;border-color:#804beb;box-shadow:0 0 5px #804beb78}.otp-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-inner-spin-button, .otp-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.cards[_ngcontent-%COMP%]{background-color:#fff;height:auto;margin-top:10px;margin-bottom:20px;font-family:Poppins,sans-serif!important;padding:28px 20px 20px;border:1px solid #d5d0e1af;box-shadow:none;border-radius:15px}.cards[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:32px}.cards-second[_ngcontent-%COMP%]{background-color:#fff;height:auto;font-family:Poppins,sans-serif!important;margin-top:30px;padding:40px;box-shadow:#0000000d 0 3px 8px;border-radius:5px}.cards-second[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:32px}.title[_ngcontent-%COMP%]{color:#382066;font-size:24px;font-family:Poppins,sans-serif!important;font-weight:600;letter-spacing:.5px}  .mat-input-element{margin-top:-1px!important;font-size:14px;display:flex;align-items:center}  .mat-form-field-appearance-outline .mat-form-field-prefix{top:1px!important}.prefix-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:5px;margin-right:9px}.flag-icon[_ngcontent-%COMP%]{width:18px!important;height:12px!important;object-fit:cover;border-radius:2px;filter:brightness(1.2) saturate(1.1)}.country-code[_ngcontent-%COMP%]{color:#a7a7ae;font-size:14px}.otp-container[_ngcontent-%COMP%]{max-width:400px;margin:50px auto;padding:20px;border:1px solid #ddd;border-radius:8px;box-shadow:0 2px 4px #0000001a;text-align:center}.form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-control[_ngcontent-%COMP%]{width:calc(100% - 20px);padding:10px;margin-top:5px;border:1px solid #ccc;border-radius:4px}.text-danger[_ngcontent-%COMP%]{color:#dc3545;font-size:.875em;text-align:left;margin-top:5px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:1em;transition:background-color .3s ease}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#a0c9f1;cursor:not-allowed}.btn-link[_ngcontent-%COMP%]{background:none;color:#007bff;text-decoration:underline;padding:0}.btn-link[_ngcontent-%COMP%]:disabled{color:#6c757d;cursor:not-allowed;text-decoration:none}.resend-section[_ngcontent-%COMP%]{margin-top:20px}.cooldown-timer[_ngcontent-%COMP%]{margin-left:10px;font-weight:700;color:#28a745}.alert[_ngcontent-%COMP%]{padding:10px;margin-bottom:15px;border-radius:4px;font-size:.9em}.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;border-color:#f5c6cb;color:#721c24}.alert-success[_ngcontent-%COMP%]{background-color:#d4edda;border-color:#c3e6cb;color:#155724}.spinner-border[_ngcontent-%COMP%]{display:inline-block;width:1rem;height:1rem;vertical-align:text-bottom;border:.15em solid currentColor;border-right-color:transparent;border-radius:50%;animation:spinner-border .75s linear infinite}@keyframes spinner-border{to{transform:rotate(360deg)}}@media (min-width: 992px){.error-msg[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#e4409a;font-size:16px;letter-spacing:.5px}.submit-button[_ngcontent-%COMP%]{height:50px;background:#804beb;color:#fff;box-shadow:none!important}.submit-button.mat-button-disabled[_ngcontent-%COMP%]:not([class*=mat-elevation-z]){background:#9f79eb;color:#f5f3fb;cursor:not-allowed}.otp-input[_ngcontent-%COMP%]{display:flex;font-family:Poppins,sans-serif!important;justify-content:left}.otp-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:48px;height:48px;font-size:20px;text-align:center;margin-left:0;margin-right:30px;margin-bottom:10px;border:1px solid #ccc;border-radius:5px}.otp-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#804beb;box-shadow:0 0 5px #804beb78}.cards[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:35px}.cards-second[_ngcontent-%COMP%]{padding:60px}.cards-second[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:32px}.title[_ngcontent-%COMP%]{color:#382066;font-size:28px;font-weight:600;letter-spacing:.5px}}"]}),e})()}];let z=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.Bz.forChild(Z),d.Bz]}),e})();var U=i(1293);let I=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.ez,z,U.g]}),e})()}}]);